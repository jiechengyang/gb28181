(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b4dee96"],{"0376":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return!e.isCheck||e.currentBtnRoute?n("div",{staticClass:"permission-button"},["tab"===e.type&&e.routeLink?n("div",[n("router-link",{attrs:{to:e.routeLink}},[e._v(e._s(e.title))])],1):e._e(),"modal"===e.type?n("div",[e.useBtnTag?n("a-button",{attrs:{type:e.btnType,icon:e.icon,disabled:e.disabled,loading:e.loading},on:{click:function(){e.$emit("handle-click")}}},[e._v(e._s(e.title))]):n("span",{class:e.classname?e.classname:"edit-btn",on:{click:function(){e.$emit("handle-click")}}},[e._v(" "+e._s(e.title))])],1):e._e(),"confirm"===e.type?n("div",[n("span",{class:e.classname?e.classname:"del-btn",on:{click:function(){e.$emit("handle-confirm")}}},[e._v(" "+e._s(e.title))])]):e._e()]):e._e()},i=[],r=n("90fe"),s={name:"PermissionButton",props:{routeLink:null,type:{type:String,default:"modal"},code:{type:String,default:""},title:{type:String,default:""},loading:{type:Boolean,default:!1},icon:{type:String,default:"plus"},useBtnTag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},classname:{type:String,default:""},btnType:{type:String,default:"primary"},isCheck:{type:Boolean,default:!0},confirm:{type:Boolean,default:!1}},data:function(){return{currentBtnRoute:null}},mounted:function(){this.checkPermission()},methods:{checkPermission:function(){if(this.isCheck){var e=this.$store.state.vueRouters.vueRouters;this.code&&e&&(this.currentBtnRoute=Object(r["j"])(e,this.code))}},handleClick:function(e){this.$emit("bclick")}}},o=s,c=(n("226f"),n("2877")),u=Object(c["a"])(o,a,i,!1,null,"3750c8b8",null);t["a"]=u.exports},"0cc4":function(e,t,n){},1028:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-popover",e._b({attrs:{trigger:"click",visible:e.visible},on:{visibleChange:e.onVisibleChange},scopedSlots:e._u([{key:"content",fn:function(){return[n("div",{staticClass:"mb-2"},[e.title?n("span",[e._v(e._s(e.title))]):e._t("title")],2),n("space",{staticClass:"actions"},[n("a-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v(e._s(e.cancelText))]),n("loading-action",{attrs:{action:e.onConfirm,size:"small",type:"primary"}},[e._v(" "+e._s(e.okText)+" ")])],1)]},proxy:!0}])},"a-popover",e.$attrs,!1),[e._t("default",null,{pop:this})],2)},i=[],r=n("1da1"),s=(n("96cf"),n("36bd")),o=n("5a99"),c={name:"LzPopconfirm",components:{LoadingAction:o["a"],Space:s["a"]},data:function(){return{visible:!1}},props:{title:{type:String,default:"确认操作？"},cancelText:{type:String,default:"取消"},okText:{type:String,default:"确认"},confirm:Function,disabled:Boolean},methods:{onCancel:function(){this.visible=!1,this.$emit("cancel")},onConfirm:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=e.confirm,!t.t0){t.next=4;break}return t.next=4,e.confirm();case 4:e.$emit("confirm"),e.visible=!1;case 6:case"end":return t.stop()}}),t)})))()},onVisibleChange:function(e){this.disabled||(this.visible=e)}}},u=c,l=(n("26ac"),n("2877")),d=Object(l["a"])(u,a,i,!1,null,"85c03b24",null);t["a"]=d.exports},"195f":function(e,t,n){},"226f":function(e,t,n){"use strict";n("d754")},"26ac":function(e,t,n){"use strict";n("195f")},"2ee8":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return f}));var a=n("28de");function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["b"].get("thirdParty/index",{params:e})}function r(e){return a["b"].promisePost("thirdParty/create",e)}function s(e,t){return a["b"].promisePost("thirdParty/edit",t,{params:{id:e}})}function o(e){return a["b"].get("thirdParty/lock",{params:{id:e}})}function c(e){return a["b"].get("thirdParty/unlock",{params:{id:e}})}function u(e){return a["b"].post("thirdParty/locks",{ids:e})}function l(e){return a["b"].post("thirdParty/unlocks",{ids:e})}function d(){return a["b"].get("thirdParty/liveProviderItems")}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a["b"].get("thirdParty/items",{params:e})}},"33c7":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"content-header"},[n("span",{staticClass:"title"},[e._v(e._s(e.realName))]),n("div",{staticClass:"flex-spacer"}),n("div",[e._t("actions")],2)]),n("div",{class:{center:e.center}},[e._t("default")],2)])},i=[],r=n("5530"),s=n("2f62"),o=n("4416"),c=n.n(o),u={name:"PageContent",props:{title:String,center:Boolean},computed:Object(r["a"])(Object(r["a"])({},Object(s["c"])({matchedMenusChain:function(e){return e.matchedMenusChain}})),{},{realName:function(){var e,t;if(this.title)return this.title;var n="";return this.matchedMenusChain.length&&(n=c()(this.matchedMenusChain).title),n||(null===(e=this.$route)||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.title)||""}})},l=u,d=(n("e4b2"),n("2877")),f=Object(d["a"])(l,a,i,!1,null,"81c7aafa",null);t["a"]=f.exports},"43b2":function(e,t,n){},"77f9":function(e,t,n){"use strict";n("cefd")},"8c45":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-header-index-wide"},[e.isTopView?n("a-card",{style:{height:"100%"},attrs:{bordered:!1,bodyStyle:{padding:"16px 0",height:"100%"}}},[n("div",{staticClass:"device-info-main"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isSuperAdminUser,expression:"isSuperAdminUser"}],staticClass:"device-info-left"},[n("a-input-search",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"输入合作方名称","enter-button":""},on:{search:e.onChange}}),n("a-list",{staticClass:"ant-menu-inline",attrs:{size:"small",bordered:"","data-source":e.thirdPartyItems,loading:e.leftLoading},scopedSlots:e._u([{key:"renderItem",fn:function(t,a){return n("a-list-item",{key:a,staticClass:"ant-menu-item",class:t.id===e.queryParams.parterId?"ant-menu-item-selected":"",attrs:{rowKey:"id","data-id":t.id},on:{click:function(n){return e.onTpSearch(t.id)}}},[e._v(" "+e._s(t.partner_name)+" ")])}}],null,!1,1081841156)},[n("div",{attrs:{slot:"header"},on:{click:function(t){return e.onSearchAll()}},slot:"header"},[e._v("全部")])])],1),n("div",{staticClass:"device-info-right",class:e.isSuperAdminUser?"":"padding0"},[n("page-content",[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{md:6,sm:12}},[n("a-form-item",{attrs:{label:"关键字"}},[n("a-input",{staticStyle:{width:"220px"},attrs:{placeholder:"输入设备名称等"},model:{value:e.queryParams.keywords,callback:function(t){e.$set(e.queryParams,"keywords",t)},expression:"queryParams.keywords"}})],1)],1),n("a-col",{attrs:{md:6,sm:12}},[n("a-form-item",{attrs:{label:"设备状态"}},[n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"全部状态","default-value":""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},[n("a-select-option",{attrs:{value:""}},[e._v("全部状态")]),e._l(e.statusItems,(function(t,a){return n("a-select-option",{key:a,attrs:{value:a}},[e._v(e._s(t))])}))],2)],1)],1),n("a-col",{attrs:{md:6,sm:12}},[n("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.refresh(!1)}}},[e._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.resetSearchForm()}}},[e._v("重置")])],1)],1)],1)],1),n("a-table",{ref:"table",attrs:{columns:e.columns,"data-source":e.nvrDevices,pagination:!1,rowSelection:e.rowSelection,loading:e.loading,rowKey:"id"},scopedSlots:e._u([{key:"device_name",fn:function(t,a){return[n("edit-table-cell",{attrs:{text:t},on:{change:function(t){return e.onCellChange(a.id,"device_name",t)}}})]}},{key:"time",fn:function(t){return n("span",{},[e._v(e._s(e._f("filterTime")(t,t)))])}},{key:"status",fn:function(t,a){return[n("a-badge",{attrs:{status:e._f("statusTypeFilter")(t),text:a.status_title}})]}},{key:"operation",fn:function(e,t){return[n("space",[n("permission-button",{attrs:{code:"device-nvr-channel",isCheck:!1,routeLink:"/device-nvr/"+t.id+"/channels",title:"查看通道",type:"tab"}}),n("permission-button",{attrs:{code:"device-nvr-show",isCheck:!1,routeLink:"/device-nvr/"+t.id+"/show",title:"详情",type:"tab"}})],1)]}}],null,!1,676600653)}),n("lz-pagination",{attrs:{page:e.paginator,autoPush:!1},on:{change:e.changePaginator,showSizeChange:e.showSizeChange}}),n("device-nvr-form",{ref:"nvrFormModal",attrs:{visible:e.visible,loading:e.confirmLoading},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)],1)])]):n("router-view")],1)},i=[],r=n("1da1"),s=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("5530")),o=n("2f62"),c={computed:Object(s["a"])(Object(s["a"])({},Object(o["c"])({user:function(e){return e.users.user}})),{},{userRoles:function(){return this.user?this.user.roles:[]}}),methods:{isSuperAdmin:function(){return this.userRoles.indexOf("ROLE_SUPER_ADMIN")>=0},isParterAdmin:function(){return this.userRoles.indexOf("ROLE_PARTER_ADMIN")>=0}}},u=n("2ee8"),l=n("aa98"),d=n("f64c"),f=n("36bd"),h=n("d613"),m=n("33c7"),p=n("1028"),g=n("90fe"),v=n("c1df"),y=n.n(v),b=n("0376"),k=n("2af9"),_=function(){return n.e("chunk-2d207b55").then(n.bind(null,"a24b"))},P={data:function(){return{statusItems:[],thirdPartyItems:[],nvrDevices:[],paginator:null,hasEdit:!1,hasDelete:!1,leftLoading:!1,leftQueryParams:{keywords:""},visible:!1,confirmLoading:!1,loading:!1,queryParams:{keywords:"",status:"",parterId:0},selectedRowKeys:[],selectedRows:[],columns:[{title:"名称",dataIndex:"device_name",key:"device_name",width:200,scopedSlots:{customRender:"device_name"}},{title:"国标编码ID",dataIndex:"device_id",key:"device_id",width:120},{title:"通道数",dataIndex:"channel_num",key:"channel_num"},{title:"设备状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"制造商",dataIndex:"manufacturer",key:"manufacturer"},{title:"模型",dataIndex:"device_model",key:"device_model"},{title:"ip",dataIndex:"local_ip",key:"local_ip"},{title:"服务端口",dataIndex:"local_sip_port",key:"local_sip_port"},{title:"所属合作方",dataIndex:"partner_title",key:"partner_title"},{title:"最新上线",dataIndex:"lastOnlineTime",key:"lastOnlineTime",scopedSlots:{customRender:"time"}},{title:"上次离线",dataIndex:"lastOfflineTime",key:"lastOfflineTime",scopedSlots:{customRender:"time"}},{title:"创建时间",dataIndex:"createdTime",key:"createdTime",scopedSlots:{customRender:"time"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}},mixins:[c],components:{LzPopconfirm:p["a"],PageContent:m["a"],LzPagination:h["a"],Space:f["a"],PermissionButton:b["a"],deviceNvrForm:_,EditTableCell:k["a"]},mounted:function(){this.isTopView&&(this.isSuperAdminUser&&this.getThirdPartyItems(),this.getStatusItems(),this.loadData(),this.checkPermissions())},computed:{isTopView:function(){return"/device/nvr/index"===this.$route.path},isSuperAdminUser:function(){return this.isSuperAdmin()},rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{getPopupContainer:function(e){return e.parentElement},checkPermissions:function(){var e=this.$store.state.vueRouters.vueRouters,t=Object(g["j"])(e,"device-nvr-edit");t&&(this.hasEdit=!0),t=Object(g["j"])(e,"device-nvr-lock"),t&&(this.hasDelete=!0)},handleEdit:function(e){},handleOk:function(){var e=this,t=this.$refs.nvrFormModal.model;this.confirmLoading=!0,this.$refs.nvrFormModal.$refs.nvrForm.validate((function(n){if(!n)return!1;Object(l["l"])(t).then((function(t){d["a"].success("保存成功"),e.visible=!1,e.confirmLoading=!1,e.refresh()}))}))},handleCancel:function(){this.visible=!1},resetSearchForm:function(){this.queryParams={keywords:"",status:"",parterId:""}},refresh:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loadData(),e&&this.resetSearchForm()},showSizeChange:function(e,t){this.queryParams=Object.assign(this.queryParams,{offset:e,limit:t}),this.refresh()},changePaginator:function(e,t){this.queryParams=Object.assign(this.queryParams,{offset:e,limit:t}),this.refresh()},getStatusItems:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["s"])();case 2:e.statusItems=t.sent;case 3:case"end":return t.stop()}}),t)})))()},loadData:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(l["r"])(e.queryParams);case 3:n=t.sent,a=n.devices,i=n.paginator,e.nvrDevices=a,e.paginator=i,e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()},getThirdPartyItems:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.leftLoading=!0,t.next=3,Object(u["e"])(e.leftQueryParams);case 3:e.thirdPartyItems=t.sent,e.leftLoading=!1;case 5:case"end":return t.stop()}}),t)})))()},onSearchAll:function(){this.queryParams.parterId="",this.loadData()},onTpSearch:function(e){this.queryParams.parterId=e,this.loadData()},onChange:function(e){this.leftQueryParams.keywords=e,this.getThirdPartyItems()},onCellChange:function(e,t,n){var a=this;if(!n)return!1;var i={device_name:n,scenario:"changeDeviceName"};Object(l["l"])(e,i).then((function(e){a.refresh()})).catch((function(e){a.$message.error(e.message||"修改出错了")}))}},filters:{filterTime:function(e){return y()(e).format("YYYY-MM-DD HH:mm")},statusTypeFilter:function(e){var t={0:"warning","-1":"error",1:"success"};return t[e]}}},w=P,S=(n("d3bf"),n("2877")),C=Object(S["a"])(w,a,i,!1,null,"7d35eef4",null);t["default"]=C.exports},cefd:function(e,t,n){},d3bf:function(e,t,n){"use strict";n("43b2")},d613:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.page?n("a-pagination",e._b({ref:"page",staticClass:"my-1 pagination",attrs:{"page-size-options":e.pageSizes,total:e.page.total,"show-size-changer":e.showSizeChanger,"show-quick-jumper":e.showQuickJumper,"show-total":function(e){return"共 "+e+" 条"},"page-size":e.perPage},on:{"update:pageSize":function(t){e.perPage=t},"update:page-size":function(t){e.perPage=t},change:e.onChange,showSizeChange:e.onSizeChange},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}},"a-pagination",e.$attrs,!1)):e._e()},i=[],r=(n("d3b7"),n("25f0"),n("99af"),{name:"LzPagination",data:function(){return{currentPage:1,perPage:15}},props:{page:Object,autoPush:{type:Boolean,default:!1},showSizeChanger:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0}},computed:{pageSizes:function(){var e=["15","30","50","100","200"],t=this.page.perPage.toString();return-1===e.indexOf(t)?[t].concat(e):e}},methods:{push:function(e){var t=e.page,n=e.perPage,a=Object.assign({},this.$route.query,{offset:t||this.currentPage,limit:n||this.perPage});this.$router.push({path:this.$route.path,query:a})},onSizeChange:function(e,t){this.$emit("showSizeChange",e,t),this.autoPush&&(this.currentPage=1,this.push({page:1,perPage:t}))},onChange:function(e,t){this.$emit("change",e,t),this.autoPush&&this.push({page:e})}},watch:{page:{handler:function(e){e&&(this.currentPage=e.currentPage,this.perPage=e.perPage)},immediate:!0}}}),s=r,o=(n("77f9"),n("2877")),c=Object(o["a"])(s,a,i,!1,null,"0efa4349",null);t["a"]=c.exports},d754:function(e,t,n){},e4b2:function(e,t,n){"use strict";n("0cc4")}}]);
//# sourceMappingURL=chunk-5b4dee96.f912bf2a.js.map