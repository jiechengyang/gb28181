{"version":3,"sources":["webpack:///./src/views/setting/Site.vue?457b","webpack:///src/views/setting/Site.vue","webpack:///./src/views/setting/Site.vue?6d2a","webpack:///./src/views/setting/Site.vue","webpack:///./src/views/setting/Site.vue?a5f2"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","form","on","handleSubmit","directives","name","rawName","value","rules","required","message","expression","validatorRules","url","type","loading","_v","staticRenderFns","data","$form","createForm","model","phone","mounted","getSettingValue","methods","setFormData","resetFields","Object","assign","$nextTick","e","preventDefault","validateFields","err","console","log","values","path","component"],"mappings":"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","file":"js/chunk-391d714e.fc1930e4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"account-settings-info-view\"},[_c('a-row',{attrs:{\"gutter\":16,\"type\":\"flex\",\"justify\":\"center\"}},[_c('a-col',{attrs:{\"order\":1,\"md\":24,\"lg\":16}},[_c('a-form',{attrs:{\"layout\":\"vertical\",\"form\":_vm.form},on:{\"submit\":_vm.handleSubmit}},[_c('a-form-item',{attrs:{\"label\":\"网站名称\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['name', { rules: [{ required: true, message: '网站名称必须填写' }] }]),expression:\"['name', { rules: [{ required: true, message: '网站名称必须填写' }] }]\"}],attrs:{\"name\":\"name\"}})],1),_c('a-form-item',{attrs:{\"label\":\"网站副标题\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['slogan']),expression:\"['slogan']\"}],attrs:{\"name\":\"slogan\"}})],1),_c('a-form-item',{attrs:{\"label\":\"网站域名\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['url', _vm.validatorRules.url]),expression:\"['url', validatorRules.url]\"}],attrs:{\"placeholder\":\"以'http://'或'https://'头\",\"name\":\"url\"}})],1),_c('a-form-item',{attrs:{\"label\":\"管理员邮箱地址\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['master_email', { rules: [{ type: 'email', message: '请输入正确的邮箱地址' }] }]),expression:\"['master_email', { rules: [{ type: 'email', message: '请输入正确的邮箱地址' }] }]\"}],attrs:{\"name\":\"master_email\"}})],1),_c('a-form-item',{attrs:{\"label\":\"ICP备案号\"}},[_c('a-input',{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:(['icp']),expression:\"['icp']\"}],attrs:{\"name\":\"icp\"}})],1),_c('a-form-item',[_c('a-button',{attrs:{\"htmlType\":\"submit\",\"type\":\"primary\",\"loading\":_vm.loading}},[_vm._v(\"保存\")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"account-settings-info-view\">\n    <a-row :gutter=\"16\" type=\"flex\" justify=\"center\">\n      <a-col :order=\"1\" :md=\"24\" :lg=\"16\">\n        <a-form layout=\"vertical\" @submit=\"handleSubmit\" :form=\"form\">\n          <a-form-item label=\"网站名称\">\n            <a-input name=\"name\" v-decorator=\"['name', { rules: [{ required: true, message: '网站名称必须填写' }] }]\" />\n          </a-form-item>\n          <a-form-item label=\"网站副标题\">\n            <a-input name=\"slogan\" v-decorator=\"['slogan']\" />\n          </a-form-item>\n          <a-form-item label=\"网站域名\">\n            <a-input placeholder=\"以'http://'或'https://'头\" name=\"url\" v-decorator=\"['url', validatorRules.url]\" />\n          </a-form-item>\n          <a-form-item label=\"管理员邮箱地址\">\n            <a-input\n              name=\"master_email\"\n              v-decorator=\"['master_email', { rules: [{ type: 'email', message: '请输入正确的邮箱地址' }] }]\"\n            />\n          </a-form-item>\n          <a-form-item label=\"ICP备案号\">\n            <a-input name=\"icp\" v-decorator=\"['icp']\" />\n          </a-form-item>\n          <a-form-item>\n            <a-button htmlType=\"submit\" type=\"primary\" :loading=\"loading\">保存</a-button>\n          </a-form-item>\n        </a-form>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n\n<script>\nimport { pick } from 'lodash'\nimport { message } from 'ant-design-vue'\nimport { getValue, editValue } from '@/api/setting'\nimport { SETTING_SITE, SYSTEM_VALIDATE_RULE_PATTERNS } from '@/libs/constants'\nexport default {\n  data() {\n    return {\n      form: this.$form.createForm(this),\n      loading: false,\n      model: {},\n      validatorRules: {\n        url: {\n          rules: [{ pattern: SYSTEM_VALIDATE_RULE_PATTERNS.URL, message: '请输入正确的url地址!' }],\n        },\n        phone: {\n          rules: [{ pattern: SYSTEM_VALIDATE_RULE_PATTERNS.PHONE, message: '请输入正确的手机号码!' }],\n        },\n      },\n    }\n  },\n  mounted() {\n    this.getSettingValue()\n  },\n  methods: {\n    async getSettingValue() {\n      const model = await getValue('site')\n      console.log('model:', model)\n      this.model = model\n      this.setFormData()\n\n      // const form = {}\n      // data.forEach((i) => {\n      //   form[i.slug] = i.value\n      // })\n      // this.form = form\n    },\n    setFormData() {\n      this.form.resetFields()\n      this.model = Object.assign({}, this.model)\n      this.$nextTick(() => {\n        this.form.setFieldsValue(pick(this.model, 'name', 'slogan', 'url', 'master_email', 'icp'))\n      })\n    },\n    handleSubmit(e) {\n      // TODO: https://www.cnblogs.com/Plume-blogs/p/14536071.html\n      e.preventDefault()\n      this.loading = true\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          console.log('Received values of form: ', values)\n          editValue('site', values).then((data) => {\n            console.log('data:', data)\n            message.success('保存成功')\n            this.$store.commit('SETTING_VALUE', {\n              path: SETTING_SITE.SLUG,\n              value: data,\n            })\n            this.loading = false\n          })\n        }\n      })\n    },\n  },\n}\n</script>\n\n<style lang=\"less\" scoped>\n.avatar-upload-wrapper {\n  height: 200px;\n  width: 100%;\n}\n\n.ant-upload-preview {\n  position: relative;\n  margin: 0 auto;\n  width: 100%;\n  max-width: 180px;\n  border-radius: 50%;\n  box-shadow: 0 0 4px #ccc;\n\n  .upload-icon {\n    position: absolute;\n    top: 0;\n    right: 10px;\n    font-size: 1.4rem;\n    padding: 0.5rem;\n    background: rgba(222, 221, 221, 0.7);\n    border-radius: 50%;\n    border: 1px solid rgba(0, 0, 0, 0.2);\n  }\n  .mask {\n    opacity: 0;\n    position: absolute;\n    background: rgba(0, 0, 0, 0.4);\n    cursor: pointer;\n    transition: opacity 0.4s;\n\n    &:hover {\n      opacity: 1;\n    }\n\n    i {\n      font-size: 2rem;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-left: -1rem;\n      margin-top: -1rem;\n      color: #d6d6d6;\n    }\n  }\n\n  img,\n  .mask {\n    width: 100%;\n    max-width: 180px;\n    height: 100%;\n    border-radius: 50%;\n    overflow: hidden;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Site.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Site.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Site.vue?vue&type=template&id=46a94324&scoped=true&\"\nimport script from \"./Site.vue?vue&type=script&lang=js&\"\nexport * from \"./Site.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Site.vue?vue&type=style&index=0&id=46a94324&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"46a94324\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Site.vue?vue&type=style&index=0&id=46a94324&lang=less&scoped=true&\""],"sourceRoot":""}