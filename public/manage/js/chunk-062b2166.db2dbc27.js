(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-062b2166"],{"0376":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return!e.isCheck||e.currentBtnRoute?n("div",{staticClass:"permission-button"},["tab"===e.type&&e.routeLink?n("div",[n("router-link",{attrs:{to:e.routeLink}},[e._v(e._s(e.title))])],1):e._e(),"modal"===e.type?n("div",[e.useBtnTag?n("a-button",{attrs:{type:e.btnType,icon:e.icon,disabled:e.disabled,loading:e.loading},on:{click:function(){e.$emit("handle-click")}}},[e._v(e._s(e.title))]):n("span",{class:e.classname?e.classname:"edit-btn",on:{click:function(){e.$emit("handle-click")}}},[e._v(" "+e._s(e.title))])],1):e._e(),"confirm"===e.type?n("div",[n("span",{class:e.classname?e.classname:"del-btn",on:{click:function(){e.$emit("handle-confirm")}}},[e._v(" "+e._s(e.title))])]):e._e()]):e._e()},i=[],s=n("90fe"),o={name:"PermissionButton",props:{routeLink:null,type:{type:String,default:"modal"},code:{type:String,default:""},title:{type:String,default:""},loading:{type:Boolean,default:!1},icon:{type:String,default:"plus"},useBtnTag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},classname:{type:String,default:""},btnType:{type:String,default:"primary"},isCheck:{type:Boolean,default:!0},confirm:{type:Boolean,default:!1}},data:function(){return{currentBtnRoute:null}},mounted:function(){this.checkPermission()},methods:{checkPermission:function(){if(this.isCheck){var e=this.$store.state.vueRouters.vueRouters;this.code&&e&&(this.currentBtnRoute=Object(s["j"])(e,this.code))}},handleClick:function(e){this.$emit("bclick")}}},r=o,c=(n("226f"),n("2877")),l=Object(c["a"])(r,a,i,!1,null,"3750c8b8",null);t["a"]=l.exports},"0cc4":function(e,t,n){},1028:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-popover",e._b({attrs:{trigger:"click",visible:e.visible},on:{visibleChange:e.onVisibleChange},scopedSlots:e._u([{key:"content",fn:function(){return[n("div",{staticClass:"mb-2"},[e.title?n("span",[e._v(e._s(e.title))]):e._t("title")],2),n("space",{staticClass:"actions"},[n("a-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v(e._s(e.cancelText))]),n("loading-action",{attrs:{action:e.onConfirm,size:"small",type:"primary"}},[e._v(" "+e._s(e.okText)+" ")])],1)]},proxy:!0}])},"a-popover",e.$attrs,!1),[e._t("default",null,{pop:this})],2)},i=[],s=n("1da1"),o=(n("96cf"),n("36bd")),r=n("5a99"),c={name:"LzPopconfirm",components:{LoadingAction:r["a"],Space:o["a"]},data:function(){return{visible:!1}},props:{title:{type:String,default:"确认操作？"},cancelText:{type:String,default:"取消"},okText:{type:String,default:"确认"},confirm:Function,disabled:Boolean},methods:{onCancel:function(){this.visible=!1,this.$emit("cancel")},onConfirm:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=e.confirm,!t.t0){t.next=4;break}return t.next=4,e.confirm();case 4:e.$emit("confirm"),e.visible=!1;case 6:case"end":return t.stop()}}),t)})))()},onVisibleChange:function(e){this.disabled||(this.visible=e)}}},l=c,u=(n("26ac"),n("2877")),d=Object(u["a"])(l,a,i,!1,null,"85c03b24",null);t["a"]=d.exports},"195f":function(e,t,n){},"226f":function(e,t,n){"use strict";n("d754")},"26ac":function(e,t,n){"use strict";n("195f")},"33c7":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"content-header"},[n("span",{staticClass:"title"},[e._v(e._s(e.realName))]),n("div",{staticClass:"flex-spacer"}),n("div",[e._t("actions")],2)]),n("div",{class:{center:e.center}},[e._t("default")],2)])},i=[],s=n("5530"),o=n("2f62"),r=n("4416"),c=n.n(r),l={name:"PageContent",props:{title:String,center:Boolean},computed:Object(s["a"])(Object(s["a"])({},Object(o["c"])({matchedMenusChain:function(e){return e.matchedMenusChain}})),{},{realName:function(){var e,t;if(this.title)return this.title;var n="";return this.matchedMenusChain.length&&(n=c()(this.matchedMenusChain).title),n||(null===(e=this.$route)||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.title)||""}})},u=l,d=(n("e4b2"),n("2877")),f=Object(d["a"])(u,a,i,!1,null,"81c7aafa",null);t["a"]=f.exports},"59b2":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("page-content",[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{layout:"inline"}},[n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{md:6,sm:12}},[n("a-form-item",{attrs:{label:"关键字"}},[n("a-input",{staticStyle:{width:"250px"},attrs:{placeholder:"输入用户名、邮箱、手机号..."},model:{value:e.queryParams.keywords,callback:function(t){e.$set(e.queryParams,"keywords",t)},expression:"queryParams.keywords"}})],1)],1),n("a-col",{attrs:{md:6,sm:12}},[n("a-form-item",{attrs:{label:"封禁状态"}},[n("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择","default-value":"0"},model:{value:e.queryParams.locked,callback:function(t){e.$set(e.queryParams,"locked",t)},expression:"queryParams.locked"}},[n("a-select-option",{attrs:{value:""}},[e._v("全部用户")]),n("a-select-option",{attrs:{value:"0"}},[e._v("非封禁用户")]),n("a-select-option",{attrs:{value:"1"}},[e._v("封禁用户")])],1)],1)],1),n("a-col",{attrs:{md:6,sm:12}},[n("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.refresh()}}},[e._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.resetSearchForm()}}},[e._v("重置")])],1)],1)],1)],1),n("div",{staticClass:"table-operator"},[n("permission-button",{attrs:{code:"user-create",title:"新建",type:"modal"},on:{"handle-click":e.handleAdd}}),e.selectedRowKeys.length>0?n("a-dropdown",{directives:[{name:"action",rawName:"v-action:edit",arg:"edit"}]},[n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",{key:"1"},[n("a-icon",{attrs:{type:"delete"}}),e._v("删除 ")],1),n("a-menu-item",{key:"2"},[n("a-icon",{attrs:{type:"lock"}}),e._v("锁定 ")],1)],1),n("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作 "),n("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),n("a-table",{ref:"table",attrs:{columns:e.columns,"data-source":e.users,pagination:!1,rowSelection:e.rowSelection,loading:e.loading,rowKey:"id"},scopedSlots:e._u([{key:"nickname",fn:function(t,a){return[n("span",{class:1==a.locked?"del-span":""},[e._v(e._s(t))])]}},{key:"time",fn:function(t){return n("span",{},[e._v(e._s(e._f("filterTime")(t,t)))])}},{key:"roles",fn:function(t,a){return e._l(a.roleTitles,(function(t){return n("a-tag",{key:t,attrs:{color:"blue"}},[e._v(e._s(t))])}))}},{key:"operation",fn:function(t,a){return[n("space",[0==a.locked&&e.hasEditRole?n("permission-button",{attrs:{code:"user-edit",isCheck:!1,title:"编辑",type:"modal",useBtnTag:!1},on:{"handle-click":function(t){return e.handleEdit(a.id)}}}):e._e(),0==a.locked&&e.hasDeleteRole&&a.roles.indexOf("ROLE_SUPER_ADMIN")<0?n("permission-button",{attrs:{confirm:!0,isCheck:!1,title:"封禁",type:"confirm"},on:{"handle-confirm":function(t){return e.handleLock(a.id)}}}):e._e()],1)]}}])}),n("lz-pagination",{attrs:{page:e.paginator,autoPush:!1},on:{change:e.changePaginator,showSizeChange:e.showSizeChange}}),n("user-form",{ref:"userFormModal",attrs:{visible:e.visible,loading:e.confirmLoading},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)},i=[],s=n("1da1"),o=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("f64c")),r=n("44c4"),c=n("36bd"),l=n("d613"),u=n("33c7"),d=n("1028"),f=n("90fe"),h=n("c1df"),m=n.n(h),p=n("0376"),g=function(){return Promise.all([n.e("chunk-2d0be333"),n.e("chunk-176ea1c2")]).then(n.bind(null,"0695"))},v={name:"Index",scroll:!0,components:{LzPopconfirm:d["a"],PageContent:u["a"],LzPagination:l["a"],Space:c["a"],PermissionButton:p["a"],UserForm:g},data:function(){return{visible:!1,confirmLoading:!1,loading:!1,queryParams:{keywords:"",locked:""},selectedRowKeys:[],selectedRows:[],columns:[{title:"ID",dataIndex:"id",key:"id",with:40},{title:"用户名",dataIndex:"nickname",key:"nickname",width:100,scopedSlots:{customRender:"nickname"}},{title:"邮箱",dataIndex:"email",key:"email",ellipsis:!0,width:250},{title:"角色",dataIndex:"roles",key:"roles",scopedSlots:{customRender:"roles"}},{title:"最近登录ip",dataIndex:"loginIp",key:"loginIp",ellipsis:!0},{title:"最近登录时间",dataIndex:"loginIpTime",key:"loginIpTime",ellipsis:!0,scopedSlots:{customRender:"time"}},{title:"添加时间",dataIndex:"createdTime",key:"createdTime",ellipsis:!0,scopedSlots:{customRender:"time"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],users:[],paginator:null,hasEditRole:!1,hasDeleteRole:!1}},mounted:function(){this.loadData(),this.checkPermissions()},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{checkPermissions:function(){var e=this.$store.state.vueRouters.vueRouters,t=Object(f["j"])(e,"user-edit");t&&(this.hasEditRole=!0),t=Object(f["j"])(e,"user-lock"),t&&(this.hasDeleteRole=!0)},handleEdit:function(e){this.$refs.userFormModal.title="编辑用户",this.$refs.userFormModal.getUser(e),this.visible=!0,this.confirmLoading=!1},handleAdd:function(){this.$refs.userFormModal.title="创建用户",this.$refs.userFormModal.model=null,this.visible=!0,this.confirmLoading=!1},handleLock:function(e){var t=this;this.$confirm({title:"确认封禁该用户?",onOk:function(){return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(r["h"])(e);case 2:a=n.sent,console.log("res:",a),o["a"].success("操作成功"),t.refresh();case 6:case"end":return n.stop()}}),n)})))()},onCancel:function(){},class:"test"})},handleCancel:function(){this.visible=!1,this.refreshForm()},refreshForm:function(){var e=this.$refs.userFormModal.form;e.resetFields()},handleOk:function(){var e=this,t=this,n=this.$refs.userFormModal.form,a=this.$refs.userFormModal.model;this.confirmLoading=!0,n.validateFields((function(n,i){n||(a?Object(r["e"])(a.id,i).then((function(n){console.log("response:",n),o["a"].success("更新成功"),t.visible=!1,t.confirmLoading=!1,t.refresh(),e.refreshForm()})).catch((function(e){o["a"].error(e.message),t.confirmLoading=!1})):Object(r["d"])(i).then((function(n){console.log("response:",n),o["a"].success("创建成功"),t.visible=!1,t.confirmLoading=!1,t.refresh(),e.refreshForm()})).catch((function(e){o["a"].error(e.message),t.visible=!1,t.confirmLoading=!1})))}))},resetSearchForm:function(){this.queryParams={keywords:"",locked:""}},refresh:function(){this.resetSearchForm(),this.loadData()},showSizeChange:function(e,t){console.log(e,t),this.queryParams=Object.assign(this.queryParams,{offset:e,limit:t}),this.refresh()},changePaginator:function(e,t){this.queryParams=Object.assign(this.queryParams,{offset:e,limit:t}),this.refresh()},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(r["g"])(e.queryParams);case 3:n=t.sent,a=n.users,i=n.paginator,e.users=a,e.paginator=i,e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()},destroyAdminRole:function(e){},dateFormat:function(e,t){var n=e[t.property];return console.log("date:",n),n?m()(n).format("YYYY-MM-DD HH:mm:ss"):""},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t}},filters:{filterTime:function(e){return m()(e).format("YYYY-MM-DD HH:mm:ss")}}},b=v,y=(n("5d1d"),n("2877")),k=Object(y["a"])(b,a,i,!1,null,"6026532e",null);t["default"]=k.exports},"5c8a":function(e,t,n){},"5d1d":function(e,t,n){"use strict";n("5c8a")},"77f9":function(e,t,n){"use strict";n("cefd")},cefd:function(e,t,n){},d613:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.page?n("a-pagination",e._b({ref:"page",staticClass:"my-1 pagination",attrs:{"page-size-options":e.pageSizes,total:e.page.total,"show-size-changer":e.showSizeChanger,"show-quick-jumper":e.showQuickJumper,"show-total":function(e){return"共 "+e+" 条"},"page-size":e.perPage},on:{"update:pageSize":function(t){e.perPage=t},"update:page-size":function(t){e.perPage=t},change:e.onChange,showSizeChange:e.onSizeChange},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}},"a-pagination",e.$attrs,!1)):e._e()},i=[],s=(n("d3b7"),n("25f0"),n("99af"),{name:"LzPagination",data:function(){return{currentPage:1,perPage:15}},props:{page:Object,autoPush:{type:Boolean,default:!1},showSizeChanger:{type:Boolean,default:!0},showQuickJumper:{type:Boolean,default:!0}},computed:{pageSizes:function(){var e=["15","30","50","100","200"],t=this.page.perPage.toString();return-1===e.indexOf(t)?[t].concat(e):e}},methods:{push:function(e){var t=e.page,n=e.perPage,a=Object.assign({},this.$route.query,{offset:t||this.currentPage,limit:n||this.perPage});this.$router.push({path:this.$route.path,query:a})},onSizeChange:function(e,t){this.$emit("showSizeChange",e,t),this.autoPush&&(this.currentPage=1,this.push({page:1,perPage:t}))},onChange:function(e,t){this.$emit("change",e,t),this.autoPush&&this.push({page:e})}},watch:{page:{handler:function(e){e&&(this.currentPage=e.currentPage,this.perPage=e.perPage)},immediate:!0}}}),o=s,r=(n("77f9"),n("2877")),c=Object(r["a"])(o,a,i,!1,null,"0efa4349",null);t["a"]=c.exports},d754:function(e,t,n){},e4b2:function(e,t,n){"use strict";n("0cc4")}}]);
//# sourceMappingURL=chunk-062b2166.db2dbc27.js.map