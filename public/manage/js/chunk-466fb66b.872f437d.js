(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-466fb66b"],{8668:function(t,i,e){"use strict";e("eeb5")},"99d5":function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticStyle:{"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none","overflow-x":"auto","overflow-y":"hidden"}},[e("span",{staticStyle:{color:"lightgrey","font-style":"italic","line-height":"24px"}},[t._v("录像计划 配置云端录像开启时段")]),e("div",{staticClass:"plans"},[e("div",{staticClass:"plan-row-header"},[e("div",{staticClass:"plan-week plan-header",staticStyle:{cursor:"pointer"},on:{click:function(i){return i.preventDefault(),t.refresh()}}},[e("i",{staticClass:"fa fa-refresh",attrs:{title:"点击还原"}}),t._v(" 重置 ")]),e("div",{staticClass:"plan-week plan-header",staticStyle:{cursor:"pointer"},on:{click:function(i){return i.preventDefault(),t.selectall()}}},[e("i",{staticClass:"fa fa-check",attrs:{title:"点击全选"}}),t._v(" 全选 ")]),e("div",{staticClass:"plan-week plan-header",staticStyle:{cursor:"pointer"},on:{click:function(i){return i.preventDefault(),t.unselectall()}}},[e("i",{staticClass:"fa fa-close",attrs:{title:"点击清空"}}),t._v(" 清空 ")])]),t._l(t.days,(function(i,n){return e("div",{key:n,staticClass:"plan-row",attrs:{index:n.toString()}},[e("div",{staticClass:"plan-week"},[t._v("星期"+t._s(i))]),e("div",{staticClass:"plan-hours"},[t._l(t.maxHour,(function(i){return e("div",{key:i.toString(),class:{"plan-title-num":!0,"plan-title-num-left":i<=1,"plan-title-num-right":i>=10}},[t._v(t._s(i%2==0||1==i?1==i?0:i:""))])})),t._l(t.maxHour,(function(i){return e("div",{key:i+"_index",class:{"plan-title-line":!0,"plan-title-line-left":i<=1}},[t._v("|")])})),e("div",{staticClass:"plan-day",attrs:{index:n.toString()},on:{mousedown:function(i){return i.preventDefault(),t.dayClick(i)}}},t._l(t.durations[n]||[],(function(i,s){return e("span",{key:s.toString()},[e("a-popover",{attrs:{placement:"top",title:"录像时间段",width:"250",trigger:"click"}},[e("template",{slot:"content"},[e("a-input",{staticStyle:{width:"46px"},attrs:{size:"small",min:0,max:23,placeholder:"时"},model:{value:t.dstarthh,callback:function(i){t.dstarthh=i},expression:"dstarthh"}}),t._v(": "),e("a-input",{staticStyle:{width:"46px"},attrs:{size:"small",min:0,max:59,placeholder:"分"},model:{value:t.dstartmm,callback:function(i){t.dstartmm=i},expression:"dstartmm"}}),t._v("- "),e("a-input",{staticStyle:{width:"46px"},attrs:{size:"small",min:0,max:23,placeholder:"时"},model:{value:t.dendhh,callback:function(i){t.dendhh=i},expression:"dendhh"}}),t._v(": "),e("a-input",{staticStyle:{width:"46px"},attrs:{size:"small",min:0,max:59,placeholder:"分"},model:{value:t.dendmm,callback:function(i){t.dendmm=i},expression:"dendmm"}}),e("div",{staticStyle:{"text-align":"center",margin:"0"}},[e("a-button",{attrs:{size:"small"},on:{click:function(i){return t.removeDuration(n,s)}}},[t._v("删除")]),e("a-button",{attrs:{size:"small"},on:{click:function(i){return t.saveDuration(n,s)}}},[t._v("保存")])],1)],1),e("div",{staticClass:"plan-duration",style:"width:"+t.durationWidth(i,n)+"%;left:"+t.durationLeft(i,n,s)+"%;",attrs:{id:"duration"+n+s,dayindex:n,durationindex:s,start:i["s"+(n+1)],end:i["e"+(n+1)]},on:{mousemove:function(i){return i.preventDefault(),t.durationmove(i,n,s)},mousedown:function(e){return e.preventDefault(),t.durationClick(e,i,n)}}})],2)],1)})),0)],2)])}))],2)])},s=[],a=e("ade3"),r=(e("ac1f"),e("1276"),e("a15b"),{props:{serial:{type:String,default:""},code:{type:String,default:""}},data:function(){var t;return t={days:["一","二","三","四","五","六","日"],checks:[],isclick:!1,recordPlan:"",isDown:!1,divIndex:0,currentDayWidth:0},Object(a["a"])(t,"isDown",!1),Object(a["a"])(t,"visible",!1),Object(a["a"])(t,"currentDuration",null),Object(a["a"])(t,"isDownLeft",!1),Object(a["a"])(t,"isDownLeft",!1),Object(a["a"])(t,"value1",""),Object(a["a"])(t,"durations",[]),Object(a["a"])(t,"originDurations",[]),Object(a["a"])(t,"dayindex",0),Object(a["a"])(t,"overIndex",-1),Object(a["a"])(t,"durationDatas",[]),Object(a["a"])(t,"prex",0),Object(a["a"])(t,"durationindex",0),Object(a["a"])(t,"startNum",0),Object(a["a"])(t,"dstarthh",""),Object(a["a"])(t,"dstartmm",""),Object(a["a"])(t,"dendhh",""),Object(a["a"])(t,"dendmm",""),Object(a["a"])(t,"moveprex",0),Object(a["a"])(t,"recordPlan",""),Object(a["a"])(t,"mouseup",null),Object(a["a"])(t,"mousemove",null),Object(a["a"])(t,"movePosNum",0),Object(a["a"])(t,"nextStartNum",0),Object(a["a"])(t,"maxHour",24),t},created:function(){},watch:{},mounted:function(){var t=this;this.mouseup=function(i){t.isDown=!1,t.isDownLeft=!1,t.isDownRight=!1,t.moveprex=0,t.movePosNum=0,t.prex=0,t.nextStartNum=0,t.checkPlanData(!1),t.log("mouse up")},this.mousemove=function(i){if(!t.isDown&&!t.isDownLeft&&!t.isDownRight)return!1;if(t.isDown){var e=t.getPosX(i);t.moveprex=e;var n=Math.floor(e/656*1440/60)+":"+Math.floor(e/656*1440%60),s=t.timeToNum(n);if(s+=30-s%30,s>1440&&(s=1440),s<=t.movePosNum)return;if(t.movePosNum=s,e==t.prex)return;if(e>t.prex){var a=t.numToTime(t.startNum),r=t.numToTime(s),o="s"+(t.dayindex+1),u="e"+(t.dayindex+1);if(t.startNum==s||a==r)return void t.log("right move ignore isDown:"+t.isDown+",prex="+t.prex+",x="+e+"datalenth="+t.durationDatas.length+",durationindex="+t.durationindex+",posNum="+s);if(t.durationindex+1<t.durationDatas.length&&(t.nextStartNum=t.timeToNum(t.durationDatas[t.durationindex+1][o]),s>t.nextStartNum))return void t.log("right move ignore 交界 isDown:"+t.isDown+",prex="+t.prex+"',x="+e+",datalenth="+t.durationDatas.length+",durationindex="+t.durationindex+",posNum="+s+",nextStart="+t.durationDatas[t.durationindex+1]["s"+(t.dayindex+1)]);0!=t.nextStartNum&&s>t.nextStartNum&&(s=t.nextStartNum,t.movePosNum=s,r=t.numToTime(s)),t.durationDatas[t.durationindex][o]=a,t.durationDatas[t.durationindex][u]=r,t.log("right move log isDown:"+t.isDown+",prex="+t.prex+",x="+e+",datalenth="+t.durationDatas.length+",durationindex="+t.durationindex+",posNum="+s),t.$set(t.durations,t.dayindex,t.durationDatas)}}},document.addEventListener("mouseup",this.mouseup),document.addEventListener("mousemove",this.mousemove)},beforeDestroy:function(){document.removeEventListener("mouseup",this.mouseup),document.removeEventListener("mousemove",this.mousemove)},methods:{init:function(t){this.originDurations=[],this.durations=[],this.durations=t?JSON.parse(t):[],this.originDurations=[];for(var i=0;i<7;i++){var e=[];this.durations[i]?e=this.durations[i]:this.durations[i]=e,this.originDurations[i]=e}},isModify:function(){if(0==this.originDurations.length)return!1;for(var t=0;t<this.durations.length;t++)if(this.originDurations[t]!=this.durations[t])return!0;return!1},log:function(t){},durationmove:function(t,i,e){if(this.isDown&&e==this.durationindex&&i==this.dayindex){var n=this.getPosX(t),s=this.timeToNum(Math.floor((this.prex+n)/656*1440/60)+":"+Math.floor((this.prex+n)/656*1440%60));s+=30-s%30,0==n&&(s=this.startNum),s>1440&&(s=1440),this.log("duration move log moveprex="+this.moveprex+",prex="+this.prex+",x="+n+",startNum="+this.startNum+",end_num="+s),s>=this.startNum&&(0!=this.nextStartNum&&s>this.nextStartNum&&(s=this.nextStartNum),this.movePosNum=s,this.durations[i][e]["e"+(i+1)]=this.numToTime(s))}},removeDuration:function(t,i){for(var e=[],n=0;n<this.durations[t].length;n++)n!=i&&e.push(this.durations[t][n]);this.$set(this.durations,t,e),$(".plan-row-header").click()},saveDuration:function(t,i){1==this.dstarthh.length&&(this.dstarthh="0"+this.dstarthh),1==this.dstartmm.length&&(this.dstartmm="0"+this.dstartmm),1==this.dendhh.length&&(this.dendhh="0"+this.dendhh),1==this.dendmm.length&&(this.dendmm="0"+this.dendmm);for(var e=this.dstarthh+":"+this.dstartmm,n=this.dendhh+":"+this.dendmm,s=[],a=this.durations[t].length,r=0;r<a;r++)if(r==i){if(this.timeToNum(e)>this.timeToNum(n))return void this.$message.warning("结束时间不能小于开始时间");if(this.timeToNum(n)>1440)return void this.$message.warning("结束时间不能大于24点");if(this.timeToNum(e)<0)return void this.$message.warning("开始时间不能小于0点");if(r>0){var o=this.durations[t][r-1];if(this.timeToNum(e)<this.timeToNum(o["e"+(t+1)]))return void this.$message.warning("开始时间须大于上一段结束时间")}if(r+1<a){o=this.durations[t][r+1];if(this.timeToNum(n)>this.timeToNum(o["s"+(t+1)]))return void this.$message.warning("结束时间须小于下一段开始时间")}var u={};u["s"+(t+1)]=e,u["e"+(t+1)]=n,s.push(u)}else s.push(this.durations[t][r]);this.$set(this.durations,t,s),$(".plan-row-header").click()},durationClick:function(t,i,e){this.dstarthh=i["s"+(e+1)].split(":")[0],this.dstartmm=i["s"+(e+1)].split(":")[1],this.dendhh=i["e"+(e+1)].split(":")[0],this.dendmm=i["e"+(e+1)].split(":")[1],t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0},dayClick:function(t){if(7==this.durations.length){this.isDown=!0;var i=this.getPosX(t);this.prex=i,this.dayindex=parseInt($(t.currentTarget).attr("index"));var e=[],n=Math.floor(i/656*1440/60)+":"+Math.floor(i/656*1440%60),s=this.timeToNum(n);this.startNum=s%30>15?s+(30-s%30):s-s%30;var a={};a["s"+(this.dayindex+1)]=this.numToTime(this.startNum),a["e"+(this.dayindex+1)]=this.numToTime(this.startNum);for(var r=!1,o=0;o<this.durations[this.dayindex].length;o++){var u=this.durations[this.dayindex][o];this.startNum<this.timeToNum(u["s"+(this.dayindex+1)])&&!r&&(r=!0,this.durationindex=o,e.push(a)),e.push(u)}0!=e.length&&r||(e.push(a),this.durationindex=e.length-1),this.durationDatas=e,this.log("day click log x="+i+",dayindex="+this.dayindex+",predatalength="+(this.durations[this.dayindex]||[]).length+",time="+a["s"+(this.dayindex+1)]+"dataarr="+this.durations[this.dayindex])}else this.$message.warning("获取录像计划中,请稍后...")},getPosX:function(t){var i;t=t||window.event;return t.offsetX||t.offsetY?(i=t.offsetX,t.offsetY):(t.layerX||t.layerY)&&(i=t.layerX,t.layerY),i=parseInt(i),i<0?i=0:i>656&&(i=656),i},timeToNum:function(t){var i=t.split(":"),e=parseInt(i[0]),n=parseInt(i[1]),s=60*e+n;return s},numToTime:function(t){var i=Math.floor(t/60)<10?"0"+Math.floor(t/60):Math.floor(t/60),e=t%60<10?"0"+t%60:t%60,n=i+":"+e;return n},durationLeft:function(t,i,e){for(var n=0,s=0;s<e;s++)n+=this.durationWidth(this.durations[i][s],i);n<0&&(n=0);var a=this.timeToNum(t["s"+(i+1)]),r=a/1440*100-n;return r},durationWidth:function(t,i){var e=this.timeToNum(t["e"+(i+1)])-this.timeToNum(t["s"+(i+1)]);return e/1440*100},refresh:function(){var t=this;this.$confirm("恢复初始配置，当前的编辑会丢失，是否继续?","提示").then((function(){t.reset()})).catch((function(){}))},getChecks:function(){var t=this.checks.join("");return t},reset:function(){for(var t=0;t<7;t++){var i=this.originDurations[t]||[];this.$set(this.durations,t,i)}},checkPlanData:function(t){for(var i=[],e=0;e<7;e++){var n=[];if(this.durations[e])for(var s=0;s<this.durations[e].length;s++){var a="s"+(e+1),r="e"+(e+1),o=this.timeToNum(this.durations[e][s][a]);if(!(o<0||o>1440)){var u=this.timeToNum(this.durations[e][s][r]);if(!(u<0||u>1440)&&!(o>=u)){var d={};if(n.length>0){var h=n[n.length-1],l=this.timeToNum(h[r]);if(o<l&&(o=l),t&&o==l){n[n.length-1][r]=this.numToTime(u);continue}}d[a]=this.numToTime(o),d[r]=this.numToTime(u),n.push(d)}}}i.push(n)}this.durations=i},getPlan:function(){return this.checkPlanData(!0),this.durations},selectall:function(){for(var t=0;t<7;t++){var i=[],e={};e["s"+(t+1)]="00:00",e["e"+(t+1)]="24:00",i.push(e),this.$set(this.durations,t,i)}},unselectall:function(){for(var t=0;t<7;t++){var i=[];this.$set(this.durations,t,i)}}}}),o=r,u=(e("8668"),e("2877")),d=Object(u["a"])(o,n,s,!1,null,"c2b20b52",null);i["default"]=d.exports},eeb5:function(t,i,e){}}]);
//# sourceMappingURL=chunk-466fb66b.872f437d.js.map